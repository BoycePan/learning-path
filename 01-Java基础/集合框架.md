# Java集合框架（Collection Framework）

## 📌 学习目标

- 掌握Java集合框架体系结构
- 熟练使用List、Set、Map等常用集合
- 理解不同集合的适用场景
- 掌握集合的遍历和操作

## ⭐ 集合框架体系

```
Collection (接口)
├── List (有序,可重复) ⭐⭐⭐⭐⭐
│   ├── ArrayList (数组实现,查询快) ⭐⭐⭐⭐⭐
│   ├── LinkedList (链表实现,增删快) ⭐⭐⭐⭐
│   └── Vector (已过时,不推荐)
│
├── Set (无序,不可重复) ⭐⭐⭐⭐⭐
│   ├── HashSet (哈希表) ⭐⭐⭐⭐⭐
│   ├── LinkedHashSet (有序HashSet) ⭐⭐⭐⭐
│   └── TreeSet (红黑树,自动排序) ⭐⭐⭐⭐
│
└── Queue (队列) ⭐⭐⭐⭐
    ├── PriorityQueue (优先队列)
    └── Deque (双端队列)

Map (键值对,非Collection子类) ⭐⭐⭐⭐⭐
├── HashMap (最常用) ⭐⭐⭐⭐⭐
├── LinkedHashMap (有序HashMap) ⭐⭐⭐⭐
├── TreeMap (自动排序) ⭐⭐⭐⭐
└── Hashtable (已过时,不推荐)
```

## 1. List接口 ⭐⭐⭐⭐⭐

### ArrayList - 最常用的List实现 ⭐⭐⭐⭐⭐

```java
import java.util.ArrayList;
import java.util.List;

public class ArrayListDemo {
    public static void main(String[] args) {
        // 创建ArrayList
        List<String> list = new ArrayList<>();
        
        // 添加元素 ⭐⭐⭐⭐⭐
        list.add("Java");
        list.add("Python");
        list.add("C++");
        list.add("Java");  // 可以重复
        System.out.println("列表：" + list);
        
        // 在指定位置添加
        list.add(1, "JavaScript");
        System.out.println("插入后：" + list);
        
        // 获取元素 ⭐⭐⭐⭐⭐
        String first = list.get(0);
        System.out.println("第一个元素：" + first);
        
        // 修改元素 ⭐⭐⭐⭐
        list.set(0, "Java 21");
        System.out.println("修改后：" + list);
        
        // 删除元素 ⭐⭐⭐⭐⭐
        list.remove(1);  // 按索引删除
        System.out.println("删除索引1：" + list);
        
        list.remove("C++");  // 按对象删除
        System.out.println("删除C++：" + list);
        
        // 查询操作 ⭐⭐⭐⭐
        System.out.println("大小：" + list.size());
        System.out.println("是否包含Java：" + list.contains("Java"));
        System.out.println("Java的索引：" + list.indexOf("Java"));
        System.out.println("是否为空：" + list.isEmpty());
        
        // 遍历方式1：for循环 ⭐⭐⭐⭐
        System.out.println("\nfor循环遍历：");
        for (int i = 0; i < list.size(); i++) {
            System.out.println(list.get(i));
        }
        
        // 遍历方式2：增强for循环（推荐） ⭐⭐⭐⭐⭐
        System.out.println("\n增强for循环：");
        for (String item : list) {
            System.out.println(item);
        }
        
        // 遍历方式3：forEach + Lambda（Java 8+，推荐） ⭐⭐⭐⭐⭐
        System.out.println("\nforEach遍历：");
        list.forEach(item -> System.out.println(item));
        
        // 遍历方式4：Stream API（现代写法） ⭐⭐⭐⭐⭐
        System.out.println("\nStream遍历：");
        list.stream().forEach(System.out::println);
        
        // 清空列表
        list.clear();
        System.out.println("\n清空后大小：" + list.size());
    }
}
```

### LinkedList - 链表实现 ⭐⭐⭐⭐

```java
import java.util.LinkedList;

public class LinkedListDemo {
    public static void main(String[] args) {
        LinkedList<String> linkedList = new LinkedList<>();
        
        // LinkedList特有方法（队列操作） ⭐⭐⭐⭐
        linkedList.addFirst("First");   // 头部添加
        linkedList.addLast("Last");     // 尾部添加
        linkedList.add("Middle");
        
        System.out.println("列表：" + linkedList);
        
        System.out.println("第一个：" + linkedList.getFirst());
        System.out.println("最后一个：" + linkedList.getLast());
        
        linkedList.removeFirst();  // 删除第一个
        linkedList.removeLast();   // 删除最后一个
        
        System.out.println("删除后：" + linkedList);
        
        // 作为栈使用 ⭐⭐⭐⭐
        LinkedList<Integer> stack = new LinkedList<>();
        stack.push(1);  // 入栈
        stack.push(2);
        stack.push(3);
        
        System.out.println("栈：" + stack);
        System.out.println("出栈：" + stack.pop());  // 出栈
        System.out.println("栈顶：" + stack.peek()); // 查看栈顶
    }
}
```

### ArrayList vs LinkedList ⭐⭐⭐⭐⭐

| 特性 | ArrayList | LinkedList |
|------|-----------|------------|
| 底层实现 | 动态数组 | 双向链表 |
| 查询速度 | O(1) 快 ⭐⭐⭐⭐⭐ | O(n) 慢 |
| 增删速度 | O(n) 慢 | O(1) 快 ⭐⭐⭐⭐⭐ |
| 内存占用 | 连续空间 | 不连续，额外指针 |
| 使用场景 | 查询多，增删少 | 频繁增删 |

## 2. Set接口 ⭐⭐⭐⭐⭐

### HashSet - 最常用的Set实现 ⭐⭐⭐⭐⭐

```java
import java.util.HashSet;
import java.util.Set;

public class HashSetDemo {
    public static void main(String[] args) {
        Set<String> set = new HashSet<>();
        
        // 添加元素（自动去重） ⭐⭐⭐⭐⭐
        set.add("Java");
        set.add("Python");
        set.add("C++");
        set.add("Java");  // 重复元素不会被添加
        
        System.out.println("Set元素：" + set);
        System.out.println("大小：" + set.size());  // 3个元素
        
        // 判断元素是否存在 ⭐⭐⭐⭐⭐
        System.out.println("包含Java：" + set.contains("Java"));
        
        // 删除元素
        set.remove("C++");
        System.out.println("删除C++后：" + set);
        
        // 遍历Set ⭐⭐⭐⭐⭐
        System.out.println("\n遍历Set：");
        for (String item : set) {
            System.out.println(item);
        }
        
        // 集合运算示例 ⭐⭐⭐⭐
        Set<Integer> set1 = new HashSet<>();
        set1.add(1);
        set1.add(2);
        set1.add(3);
        
        Set<Integer> set2 = new HashSet<>();
        set2.add(3);
        set2.add(4);
        set2.add(5);
        
        // 并集
        Set<Integer> union = new HashSet<>(set1);
        union.addAll(set2);
        System.out.println("\n并集：" + union);
        
        // 交集
        Set<Integer> intersection = new HashSet<>(set1);
        intersection.retainAll(set2);
        System.out.println("交集：" + intersection);
        
        // 差集
        Set<Integer> difference = new HashSet<>(set1);
        difference.removeAll(set2);
        System.out.println("差集：" + difference);
    }
}
```

### TreeSet - 自动排序的Set ⭐⭐⭐⭐

```java
import java.util.TreeSet;
import java.util.Set;

public class TreeSetDemo {
    public static void main(String[] args) {
        // TreeSet自动排序 ⭐⭐⭐⭐
        Set<Integer> treeSet = new TreeSet<>();
        treeSet.add(5);
        treeSet.add(1);
        treeSet.add(3);
        treeSet.add(2);
        treeSet.add(4);
        
        System.out.println("TreeSet（自动排序）：" + treeSet);
        // 输出：[1, 2, 3, 4, 5]
        
        // 字符串排序
        TreeSet<String> names = new TreeSet<>();
        names.add("张三");
        names.add("李四");
        names.add("王五");
        names.add("赵六");
        
        System.out.println("姓名排序：" + names);
    }
}
```

## 3. Map接口 ⭐⭐⭐⭐⭐

### HashMap - 最常用的Map实现 ⭐⭐⭐⭐⭐

```java
import java.util.HashMap;
import java.util.Map;

public class HashMapDemo {
    public static void main(String[] args) {
        // 创建HashMap
        Map<String, Integer> map = new HashMap<>();
        
        // 添加键值对 ⭐⭐⭐⭐⭐
        map.put("语文", 90);
        map.put("数学", 95);
        map.put("英语", 88);
        map.put("物理", 92);
        
        System.out.println("成绩：" + map);
        
        // 获取值 ⭐⭐⭐⭐⭐
        int mathScore = map.get("数学");
        System.out.println("数学成绩：" + mathScore);
        
        // 如果key不存在，返回默认值 ⭐⭐⭐⭐
        int chemistry = map.getOrDefault("化学", 0);
        System.out.println("化学成绩：" + chemistry);
        
        // 判断key或value是否存在 ⭐⭐⭐⭐
        System.out.println("包含语文：" + map.containsKey("语文"));
        System.out.println("包含成绩95：" + map.containsValue(95));
        
        // 修改值
        map.put("数学", 98);  // key存在则修改
        System.out.println("修改后：" + map);
        
        // 删除 ⭐⭐⭐⭐
        map.remove("物理");
        System.out.println("删除物理后：" + map);
        
        // 遍历方式1：遍历key ⭐⭐⭐⭐⭐
        System.out.println("\n遍历key：");
        for (String subject : map.keySet()) {
            System.out.println(subject + ": " + map.get(subject));
        }
        
        // 遍历方式2：遍历Entry（推荐） ⭐⭐⭐⭐⭐
        System.out.println("\n遍历Entry：");
        for (Map.Entry<String, Integer> entry : map.entrySet()) {
            System.out.println(entry.getKey() + ": " + entry.getValue());
        }
        
        // 遍历方式3：forEach（Java 8+，推荐） ⭐⭐⭐⭐⭐
        System.out.println("\nforEach遍历：");
        map.forEach((subject, score) -> {
            System.out.println(subject + ": " + score);
        });
        
        // 常用操作 ⭐⭐⭐⭐
        System.out.println("\nMap大小：" + map.size());
        System.out.println("所有科目：" + map.keySet());
        System.out.println("所有成绩：" + map.values());
    }
}
```

### HashMap高级用法 ⭐⭐⭐⭐⭐

```java
import java.util.HashMap;
import java.util.Map;

public class HashMapAdvanced {
    public static void main(String[] args) {
        Map<String, Integer> wordCount = new HashMap<>();
        String[] words = {"java", "python", "java", "c++", "python", "java"};
        
        // 统计单词出现次数 ⭐⭐⭐⭐⭐
        for (String word : words) {
            // 传统方式
            // if (wordCount.containsKey(word)) {
            //     wordCount.put(word, wordCount.get(word) + 1);
            // } else {
            //     wordCount.put(word, 1);
            // }
            
            // 简洁方式（Java 8+）
            wordCount.put(word, wordCount.getOrDefault(word, 0) + 1);
        }
        
        System.out.println("单词计数：" + wordCount);
        
        // putIfAbsent - 如果key不存在才添加 ⭐⭐⭐⭐
        wordCount.putIfAbsent("go", 1);
        wordCount.putIfAbsent("java", 10);  // java已存在，不会修改
        System.out.println("putIfAbsent后：" + wordCount);
        
        // compute系列方法 ⭐⭐⭐⭐
        wordCount.compute("java", (k, v) -> v == null ? 1 : v + 1);
        System.out.println("compute后：" + wordCount);
        
        // merge方法 ⭐⭐⭐⭐
        wordCount.merge("python", 5, Integer::sum);  // 存在则累加
        wordCount.merge("rust", 1, Integer::sum);    // 不存在则设置
        System.out.println("merge后：" + wordCount);
    }
}
```

### TreeMap - 自动排序的Map ⭐⭐⭐⭐

```java
import java.util.TreeMap;
import java.util.Map;

public class TreeMapDemo {
    public static void main(String[] args) {
        // TreeMap按key自动排序 ⭐⭐⭐⭐
        Map<String, String> treeMap = new TreeMap<>();
        treeMap.put("c", "C语言");
        treeMap.put("a", "A语言");
        treeMap.put("b", "B语言");
        
        System.out.println("TreeMap（按key排序）：");
        treeMap.forEach((k, v) -> System.out.println(k + " -> " + v));
        
        // 数字排序
        TreeMap<Integer, String> scores = new TreeMap<>();
        scores.put(95, "优秀");
        scores.put(85, "良好");
        scores.put(75, "中等");
        scores.put(60, "及格");
        
        System.out.println("\n成绩等级：" + scores);
    }
}
```

## 4. 实用工具类 Collections ⭐⭐⭐⭐⭐

```java
import java.util.*;

public class CollectionsDemo {
    public static void main(String[] args) {
        List<Integer> numbers = new ArrayList<>(Arrays.asList(5, 2, 8, 1, 9, 3));
        
        System.out.println("原始列表：" + numbers);
        
        // 排序 ⭐⭐⭐⭐⭐
        Collections.sort(numbers);
        System.out.println("升序排序：" + numbers);
        
        // 倒序排序 ⭐⭐⭐⭐⭐
        Collections.sort(numbers, Collections.reverseOrder());
        System.out.println("降序排序：" + numbers);
        
        // 反转 ⭐⭐⭐⭐
        Collections.reverse(numbers);
        System.out.println("反转：" + numbers);
        
        // 打乱 ⭐⭐⭐⭐
        Collections.shuffle(numbers);
        System.out.println("打乱：" + numbers);
        
        // 最大值和最小值 ⭐⭐⭐⭐⭐
        System.out.println("最大值：" + Collections.max(numbers));
        System.out.println("最小值：" + Collections.min(numbers));
        
        // 查找 ⭐⭐⭐⭐
        Collections.sort(numbers);  // 二分查找需要先排序
        int index = Collections.binarySearch(numbers, 5);
        System.out.println("5的索引：" + index);
        
        // 填充 ⭐⭐⭐
        Collections.fill(numbers, 0);
        System.out.println("填充0：" + numbers);
        
        // 创建不可修改集合 ⭐⭐⭐⭐
        List<String> immutableList = Collections.unmodifiableList(
            Arrays.asList("Java", "Python", "C++")
        );
        // immutableList.add("Go");  // 会抛出异常
        
        // 创建空集合（性能优化） ⭐⭐⭐⭐
        List<String> emptyList = Collections.emptyList();
        Set<String> emptySet = Collections.emptySet();
        Map<String, String> emptyMap = Collections.emptyMap();
    }
}
```

## 5. 现代集合操作（Java 9+） ⭐⭐⭐⭐⭐

```java
import java.util.*;

public class ModernCollections {
    public static void main(String[] args) {
        // List.of() - 创建不可变List（Java 9+） ⭐⭐⭐⭐⭐
        List<String> languages = List.of("Java", "Python", "C++", "Go");
        System.out.println("不可变List：" + languages);
        
        // Set.of() - 创建不可变Set ⭐⭐⭐⭐⭐
        Set<Integer> numbers = Set.of(1, 2, 3, 4, 5);
        System.out.println("不可变Set：" + numbers);
        
        // Map.of() - 创建不可变Map ⭐⭐⭐⭐⭐
        Map<String, Integer> scores = Map.of(
            "语文", 90,
            "数学", 95,
            "英语", 88
        );
        System.out.println("不可变Map：" + scores);
        
        // Map.ofEntries() - 超过10个键值对时使用 ⭐⭐⭐⭐
        Map<String, String> map = Map.ofEntries(
            Map.entry("key1", "value1"),
            Map.entry("key2", "value2"),
            Map.entry("key3", "value3")
        );
        
        // copyOf() - 创建副本（Java 10+） ⭐⭐⭐⭐
        List<String> copy = List.copyOf(languages);
        
        // Stream API操作集合（重要！） ⭐⭐⭐⭐⭐
        List<Integer> nums = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
        
        // 过滤偶数并求和
        int sum = nums.stream()
                      .filter(n -> n % 2 == 0)
                      .mapToInt(Integer::intValue)
                      .sum();
        System.out.println("\n偶数之和：" + sum);
        
        // 转换和收集
        List<String> strNumbers = nums.stream()
                                      .map(String::valueOf)
                                      .toList();  // Java 16+
        System.out.println("转为字符串：" + strNumbers);
    }
}
```

## 💡 集合选择指南 ⭐⭐⭐⭐⭐

### 何时使用哪种集合？

| 需求 | 推荐集合 | 原因 |
|------|---------|------|
| 需要索引访问 | **ArrayList** | 快速随机访问 |
| 频繁增删 | **LinkedList** | 高效插入删除 |
| 去重 | **HashSet** | 自动去重 |
| 去重+排序 | **TreeSet** | 自动排序 |
| 键值对存储 | **HashMap** | 最常用 |
| 键值对+排序 | **TreeMap** | 按key排序 |
| 保持插入顺序 | **LinkedHashMap** | 有序Map |
| 队列/栈 | **LinkedList/ArrayDeque** | 队列操作 |

### 性能对比 ⭐⭐⭐⭐⭐

| 操作 | ArrayList | LinkedList | HashMap | TreeMap |
|------|-----------|------------|---------|---------|
| 查询 | O(1) ⭐⭐⭐⭐⭐ | O(n) | O(1) ⭐⭐⭐⭐⭐ | O(log n) |
| 插入 | O(n) | O(1) ⭐⭐⭐⭐⭐ | O(1) ⭐⭐⭐⭐⭐ | O(log n) |
| 删除 | O(n) | O(1) ⭐⭐⭐⭐⭐ | O(1) ⭐⭐⭐⭐⭐ | O(log n) |

## 🎯 实战示例

### 学生成绩管理系统

```java
import java.util.*;

public class StudentScoreManager {
    public static void main(String[] args) {
        // 使用Map存储学生成绩
        Map<String, List<Integer>> studentScores = new HashMap<>();
        
        // 添加学生成绩
        studentScores.put("张三", Arrays.asList(90, 85, 88));
        studentScores.put("李四", Arrays.asList(95, 92, 89));
        studentScores.put("王五", Arrays.asList(78, 82, 85));
        
        // 计算每个学生的平均分
        System.out.println("学生平均分：");
        studentScores.forEach((name, scores) -> {
            double average = scores.stream()
                                   .mapToInt(Integer::intValue)
                                   .average()
                                   .orElse(0.0);
            System.out.printf("%s: %.2f分\n", name, average);
        });
        
        // 找出最高平均分
        String topStudent = studentScores.entrySet().stream()
            .max((e1, e2) -> {
                double avg1 = e1.getValue().stream().mapToInt(Integer::intValue).average().orElse(0);
                double avg2 = e2.getValue().stream().mapToInt(Integer::intValue).average().orElse(0);
                return Double.compare(avg1, avg2);
            })
            .map(Map.Entry::getKey)
            .orElse("无");
        
        System.out.println("\n最高平均分学生：" + topStudent);
    }
}
```

## 💡 重点总结

1. **ArrayList是最常用的集合** - 90%的场景都用它
2. **HashMap是最常用的Map** - 键值对存储首选
3. **使用泛型** - `List<String>` 而不是 `List`
4. **优先使用接口** - `List<String>` 而不是 `ArrayList<String>`
5. **Java 9+使用of()方法** - 创建不可变集合更简洁
6. **掌握Stream API** - 现代Java集合操作的核心

## 🎯 练习建议

1. 实现一个简单的通讯录（使用Map）
2. 对学生列表进行排序（使用Comparable）
3. 统计文章中单词出现频率
4. 实现一个购物车系统
5. 使用Set去除重复数据

## 📚 下一步

学习完集合框架后，继续学习 [异常处理](./异常处理.md)


# Javaè®¾è®¡æ¨¡å¼

## ğŸ“Œ å­¦ä¹ ç›®æ ‡

- ç†è§£è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ
- æŒæ¡å¸¸ç”¨è®¾è®¡æ¨¡å¼
- ç†è§£è®¾è®¡åŸåˆ™
- èƒ½åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨
- è¯†åˆ«æ¡†æ¶ä¸­çš„è®¾è®¡æ¨¡å¼

## â­ æ ¸å¿ƒå†…å®¹

- **å•ä¾‹æ¨¡å¼** â­â­â­â­â­
- **å·¥å‚æ¨¡å¼** â­â­â­â­â­
- **ä»£ç†æ¨¡å¼** â­â­â­â­â­
- **è§‚å¯Ÿè€…æ¨¡å¼** â­â­â­â­â­
- **ç­–ç•¥æ¨¡å¼** â­â­â­â­â­

## 1. è®¾è®¡æ¨¡å¼æ¦‚è¿° â­â­â­â­â­

### ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ

è®¾è®¡æ¨¡å¼æ˜¯**è½¯ä»¶è®¾è®¡ä¸­å¸¸è§é—®é¢˜çš„å…¸å‹è§£å†³æ–¹æ¡ˆ**ï¼Œæ˜¯å‰äººç»éªŒçš„æ€»ç»“ã€‚

### å…­å¤§è®¾è®¡åŸåˆ™ â­â­â­â­â­

```java
// 1. å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰â­â­â­â­â­
// ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
class UserService {
    void saveUser(User user) { }  // åªè´Ÿè´£ç”¨æˆ·ä¸šåŠ¡
}
class UserValidator {
    boolean validate(User user) { }  // åªè´Ÿè´£éªŒè¯
}

// 2. å¼€é—­åŸåˆ™ï¼ˆOCPï¼‰â­â­â­â­â­
// å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
interface PaymentStrategy {
    void pay(double amount);
}
class AlipayPayment implements PaymentStrategy { }
class WechatPayment implements PaymentStrategy { }

// 3. é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLSPï¼‰â­â­â­â­
// å­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»
class Bird { void fly() { } }
class Sparrow extends Bird { }  // å¯ä»¥æ›¿æ¢Bird

// 4. æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼‰â­â­â­â­
// æ¥å£åº”è¯¥å°è€Œä¸“ä¸€
interface Readable { void read(); }
interface Writable { void write(); }

// 5. ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰â­â­â­â­â­
// ä¾èµ–æŠ½è±¡è€Œä¸æ˜¯å…·ä½“å®ç°
class UserService {
    private UserRepository repository;  // ä¾èµ–æ¥å£
    UserService(UserRepository repository) {
        this.repository = repository;
    }
}

// 6. è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLoDï¼‰â­â­â­â­
// æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œé™ä½è€¦åˆ
```

## 2. åˆ›å»ºå‹æ¨¡å¼

### å•ä¾‹æ¨¡å¼ â­â­â­â­â­

```java
// 1. é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œæ¨èï¼‰â­â­â­â­â­
public class Singleton1 {
    private static final Singleton1 INSTANCE = new Singleton1();
    
    private Singleton1() {}
    
    public static Singleton1 getInstance() {
        return INSTANCE;
    }
}

// 2. æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æŸ¥é”ï¼Œæ¨èï¼‰â­â­â­â­â­
public class Singleton2 {
    private static volatile Singleton2 instance;
    
    private Singleton2() {}
    
    public static Singleton2 getInstance() {
        if (instance == null) {
            synchronized (Singleton2.class) {
                if (instance == null) {
                    instance = new Singleton2();
                }
            }
        }
        return instance;
    }
}

// 3. é™æ€å†…éƒ¨ç±»ï¼ˆæ¨èï¼‰â­â­â­â­â­
public class Singleton3 {
    private Singleton3() {}
    
    private static class Holder {
        private static final Singleton3 INSTANCE = new Singleton3();
    }
    
    public static Singleton3 getInstance() {
        return Holder.INSTANCE;
    }
}

// 4. æšä¸¾ï¼ˆæœ€å®‰å…¨ï¼Œæ¨èï¼‰â­â­â­â­â­
public enum Singleton4 {
    INSTANCE;
    
    public void doSomething() {
        System.out.println("Singleton method");
    }
}

// ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®åº“è¿æ¥æ± ã€é…ç½®ç®¡ç†å™¨ã€æ—¥å¿—å¯¹è±¡
```

### å·¥å‚æ¨¡å¼ â­â­â­â­â­

```java
// ç®€å•å·¥å‚ â­â­â­â­â­
interface Product {
    void use();
}

class ProductA implements Product {
    public void use() { System.out.println("ä½¿ç”¨äº§å“A"); }
}

class ProductB implements Product {
    public void use() { System.out.println("ä½¿ç”¨äº§å“B"); }
}

class SimpleFactory {
    public static Product createProduct(String type) {
        switch (type) {
            case "A": return new ProductA();
            case "B": return new ProductB();
            default: throw new IllegalArgumentException("æœªçŸ¥ç±»å‹");
        }
    }
}

// å·¥å‚æ–¹æ³• â­â­â­â­â­
interface Factory {
    Product createProduct();
}

class FactoryA implements Factory {
    public Product createProduct() {
        return new ProductA();
    }
}

class FactoryB implements Factory {
    public Product createProduct() {
        return new ProductB();
    }
}

// æŠ½è±¡å·¥å‚ â­â­â­â­
interface AbstractFactory {
    Product createProductA();
    Product createProductB();
}

class ConcreteFactory implements AbstractFactory {
    public Product createProductA() { return new ProductA(); }
    public Product createProductB() { return new ProductB(); }
}

// ä½¿ç”¨åœºæ™¯ï¼šSpring BeanFactoryã€JDBC DriverManager
```

### å»ºé€ è€…æ¨¡å¼ â­â­â­â­â­

```java
// å¤æ‚å¯¹è±¡çš„æ„å»º
public class User {
    private final String name;        // å¿…å¡«
    private final String email;       // å¿…å¡«
    private final int age;            // å¯é€‰
    private final String phone;       // å¯é€‰
    private final String address;     // å¯é€‰
    
    private User(Builder builder) {
        this.name = builder.name;
        this.email = builder.email;
        this.age = builder.age;
        this.phone = builder.phone;
        this.address = builder.address;
    }
    
    public static class Builder {
        private final String name;
        private final String email;
        private int age;
        private String phone;
        private String address;
        
        public Builder(String name, String email) {
            this.name = name;
            this.email = email;
        }
        
        public Builder age(int age) {
            this.age = age;
            return this;
        }
        
        public Builder phone(String phone) {
            this.phone = phone;
            return this;
        }
        
        public Builder address(String address) {
            this.address = address;
            return this;
        }
        
        public User build() {
            return new User(this);
        }
    }
}

// ä½¿ç”¨ â­â­â­â­â­
User user = new User.Builder("Alice", "alice@example.com")
    .age(25)
    .phone("13800138000")
    .address("Beijing")
    .build();

// ä½¿ç”¨åœºæ™¯ï¼šLombok @Builderã€StringBuilderã€Stream.Builder
```

## 3. ç»“æ„å‹æ¨¡å¼

### ä»£ç†æ¨¡å¼ â­â­â­â­â­

```java
// é™æ€ä»£ç†
interface UserService {
    void save(User user);
}

class UserServiceImpl implements UserService {
    public void save(User user) {
        System.out.println("ä¿å­˜ç”¨æˆ·ï¼š" + user.getName());
    }
}

class UserServiceProxy implements UserService {
    private UserService target;
    
    public UserServiceProxy(UserService target) {
        this.target = target;
    }
    
    public void save(User user) {
        System.out.println("å¼€å¯äº‹åŠ¡");
        target.save(user);
        System.out.println("æäº¤äº‹åŠ¡");
    }
}

// åŠ¨æ€ä»£ç†è§"åå°„ä¸åŠ¨æ€ä»£ç†"ç« èŠ‚ â­â­â­â­â­
// ä½¿ç”¨åœºæ™¯ï¼šSpring AOPã€MyBatis Mapperã€RPCæ¡†æ¶
```

### è£…é¥°å™¨æ¨¡å¼ â­â­â­â­

```java
// åŠ¨æ€æ·»åŠ åŠŸèƒ½
interface Coffee {
    double cost();
    String description();
}

class SimpleCoffee implements Coffee {
    public double cost() { return 10.0; }
    public String description() { return "æ™®é€šå’–å•¡"; }
}

abstract class CoffeeDecorator implements Coffee {
    protected Coffee coffee;
    
    public CoffeeDecorator(Coffee coffee) {
        this.coffee = coffee;
    }
}

class MilkDecorator extends CoffeeDecorator {
    public MilkDecorator(Coffee coffee) { super(coffee); }
    
    public double cost() { return coffee.cost() + 2.0; }
    public String description() { return coffee.description() + " + ç‰›å¥¶"; }
}

class SugarDecorator extends CoffeeDecorator {
    public SugarDecorator(Coffee coffee) { super(coffee); }
    
    public double cost() { return coffee.cost() + 1.0; }
    public String description() { return coffee.description() + " + ç³–"; }
}

// ä½¿ç”¨ â­â­â­â­â­
Coffee coffee = new SimpleCoffee();
coffee = new MilkDecorator(coffee);
coffee = new SugarDecorator(coffee);
System.out.println(coffee.description() + " = " + coffee.cost());
// è¾“å‡ºï¼šæ™®é€šå’–å•¡ + ç‰›å¥¶ + ç³– = 13.0

// ä½¿ç”¨åœºæ™¯ï¼šJava IOæµã€Spring Cache
```

### é€‚é…å™¨æ¨¡å¼ â­â­â­â­

```java
// å°†ä¸€ä¸ªæ¥å£è½¬æ¢æˆå¦ä¸€ä¸ªæ¥å£
interface Target {
    void request();
}

class Adaptee {
    void specificRequest() {
        System.out.println("ç‰¹æ®Šè¯·æ±‚");
    }
}

class Adapter implements Target {
    private Adaptee adaptee;
    
    public Adapter(Adaptee adaptee) {
        this.adaptee = adaptee;
    }
    
    public void request() {
        adaptee.specificRequest();
    }
}

// ä½¿ç”¨åœºæ™¯ï¼šSpring MVC HandlerAdapterã€JDBC-ODBCæ¡¥
```

## 4. è¡Œä¸ºå‹æ¨¡å¼

### ç­–ç•¥æ¨¡å¼ â­â­â­â­â­

```java
// å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œè®©å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢
interface PaymentStrategy {
    void pay(double amount);
}

class AlipayStrategy implements PaymentStrategy {
    public void pay(double amount) {
        System.out.println("æ”¯ä»˜å®æ”¯ä»˜ï¼š" + amount);
    }
}

class WechatStrategy implements PaymentStrategy {
    public void pay(double amount) {
        System.out.println("å¾®ä¿¡æ”¯ä»˜ï¼š" + amount);
    }
}

class CreditCardStrategy implements PaymentStrategy {
    public void pay(double amount) {
        System.out.println("ä¿¡ç”¨å¡æ”¯ä»˜ï¼š" + amount);
    }
}

class PaymentContext {
    private PaymentStrategy strategy;
    
    public void setStrategy(PaymentStrategy strategy) {
        this.strategy = strategy;
    }
    
    public void pay(double amount) {
        strategy.pay(amount);
    }
}

// ä½¿ç”¨ â­â­â­â­â­
PaymentContext context = new PaymentContext();
context.setStrategy(new AlipayStrategy());
context.pay(100.0);

context.setStrategy(new WechatStrategy());
context.pay(200.0);

// ä½¿ç”¨åœºæ™¯ï¼šæ”¯ä»˜æ–¹å¼ã€æ’åºç®—æ³•ã€Spring Resource
```

### è§‚å¯Ÿè€…æ¨¡å¼ â­â­â­â­â­

```java
// ä¸€å¯¹å¤šä¾èµ–ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥
interface Observer {
    void update(String message);
}

class ConcreteObserver implements Observer {
    private String name;
    
    public ConcreteObserver(String name) {
        this.name = name;
    }
    
    public void update(String message) {
        System.out.println(name + " æ”¶åˆ°æ¶ˆæ¯ï¼š" + message);
    }
}

class Subject {
    private List<Observer> observers = new ArrayList<>();
    
    public void attach(Observer observer) {
        observers.add(observer);
    }
    
    public void detach(Observer observer) {
        observers.remove(observer);
    }
    
    public void notifyObservers(String message) {
        for (Observer observer : observers) {
            observer.update(message);
        }
    }
}

// ä½¿ç”¨ â­â­â­â­â­
Subject subject = new Subject();
subject.attach(new ConcreteObserver("è§‚å¯Ÿè€…1"));
subject.attach(new ConcreteObserver("è§‚å¯Ÿè€…2"));
subject.notifyObservers("Hello!");

// ä½¿ç”¨åœºæ™¯ï¼šSpring Eventã€MQæ¶ˆæ¯ã€GUIäº‹ä»¶
```

### æ¨¡æ¿æ–¹æ³•æ¨¡å¼ â­â­â­â­â­

```java
// å®šä¹‰ç®—æ³•éª¨æ¶ï¼Œå­ç±»å®ç°å…·ä½“æ­¥éª¤
abstract class AbstractTemplate {
    // æ¨¡æ¿æ–¹æ³• â­â­â­â­â­
    public final void execute() {
        step1();
        step2();
        step3();
    }
    
    protected abstract void step1();
    protected abstract void step2();
    
    protected void step3() {
        System.out.println("é»˜è®¤å®ç°");
    }
}

class ConcreteTemplate extends AbstractTemplate {
    protected void step1() {
        System.out.println("å…·ä½“å®ç°1");
    }
    
    protected void step2() {
        System.out.println("å…·ä½“å®ç°2");
    }
}

// ä½¿ç”¨åœºæ™¯ï¼šSpring JdbcTemplateã€Servletã€JUnit
```

### è´£ä»»é“¾æ¨¡å¼ â­â­â­â­

```java
// è¯·æ±‚æ²¿ç€é“¾ä¼ é€’ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒ
abstract class Handler {
    protected Handler next;
    
    public void setNext(Handler next) {
        this.next = next;
    }
    
    public abstract void handleRequest(Request request);
}

class ConcreteHandler1 extends Handler {
    public void handleRequest(Request request) {
        if (request.getLevel() == 1) {
            System.out.println("Handler1å¤„ç†");
        } else if (next != null) {
            next.handleRequest(request);
        }
    }
}

class ConcreteHandler2 extends Handler {
    public void handleRequest(Request request) {
        if (request.getLevel() == 2) {
            System.out.println("Handler2å¤„ç†");
        } else if (next != null) {
            next.handleRequest(request);
        }
    }
}

// ä½¿ç”¨ â­â­â­â­â­
Handler h1 = new ConcreteHandler1();
Handler h2 = new ConcreteHandler2();
h1.setNext(h2);
h1.handleRequest(new Request(2));

// ä½¿ç”¨åœºæ™¯ï¼šServlet Filterã€Spring Interceptorã€Netty Pipeline
```

## 5. æ¡†æ¶ä¸­çš„è®¾è®¡æ¨¡å¼ â­â­â­â­â­

### Springæ¡†æ¶

```java
// 1. å•ä¾‹æ¨¡å¼ - Spring Beané»˜è®¤å•ä¾‹ â­â­â­â­â­
@Component
public class UserService { }

// 2. å·¥å‚æ¨¡å¼ - BeanFactory â­â­â­â­â­
ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
UserService service = context.getBean(UserService.class);

// 3. ä»£ç†æ¨¡å¼ - AOP â­â­â­â­â­
@Aspect
public class LogAspect {
    @Around("execution(* com.example..*(..))")
    public Object log(ProceedingJoinPoint pjp) throws Throwable {
        System.out.println("æ–¹æ³•æ‰§è¡Œå‰");
        Object result = pjp.proceed();
        System.out.println("æ–¹æ³•æ‰§è¡Œå");
        return result;
    }
}

// 4. æ¨¡æ¿æ–¹æ³• - JdbcTemplate â­â­â­â­â­
jdbcTemplate.query("SELECT * FROM user", (rs, rowNum) -> {
    User user = new User();
    user.setId(rs.getLong("id"));
    user.setName(rs.getString("name"));
    return user;
});

// 5. è§‚å¯Ÿè€…æ¨¡å¼ - ApplicationEvent â­â­â­â­â­
@Component
public class UserEventListener {
    @EventListener
    public void handleUserCreated(UserCreatedEvent event) {
        System.out.println("ç”¨æˆ·åˆ›å»ºï¼š" + event.getUser());
    }
}

// 6. ç­–ç•¥æ¨¡å¼ - Resource â­â­â­â­
Resource resource = new ClassPathResource("config.properties");
Resource resource2 = new FileSystemResource("/path/to/file");
```

### MyBatisæ¡†æ¶

```java
// 1. å»ºé€ è€…æ¨¡å¼ - SqlSessionFactoryBuilder â­â­â­â­â­
SqlSessionFactory factory = new SqlSessionFactoryBuilder()
    .build(inputStream);

// 2. å·¥å‚æ¨¡å¼ - SqlSessionFactory â­â­â­â­â­
SqlSession session = factory.openSession();

// 3. ä»£ç†æ¨¡å¼ - Mapperæ¥å£ â­â­â­â­â­
UserMapper mapper = session.getMapper(UserMapper.class);
```

## ğŸ’¡ æœ€ä½³å®è·µ â­â­â­â­â­

### 1. ä½•æ—¶ä½¿ç”¨è®¾è®¡æ¨¡å¼

```java
// ä¸è¦è¿‡åº¦è®¾è®¡
// ç®€å•åœºæ™¯ï¼š
if (type.equals("A")) {
    return new ProductA();
} else {
    return new ProductB();
}

// å¤æ‚åœºæ™¯æ‰ä½¿ç”¨å·¥å‚æ¨¡å¼
```

### 2. ç»„åˆä¼˜äºç»§æ‰¿

```java
// ä¸å¥½ï¼šç»§æ‰¿
class ColoredShape extends Shape { }

// å¥½ï¼šç»„åˆ â­â­â­â­â­
class Shape {
    private Color color;
}
```

### 3. é¢å‘æ¥å£ç¼–ç¨‹

```java
// ä¸å¥½
ArrayList<String> list = new ArrayList<>();

// å¥½ â­â­â­â­â­
List<String> list = new ArrayList<>();
```

## ğŸ¯ å®æˆ˜ç»ƒä¹ 

1. å®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼
2. ä½¿ç”¨ç­–ç•¥æ¨¡å¼å®ç°å¤šç§æ’åºç®—æ³•
3. ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼å¢å¼ºåŠŸèƒ½
4. ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å®ç°äº‹ä»¶ç³»ç»Ÿ

## ğŸ“š ä¸‹ä¸€æ­¥

å­¦ä¹ å®Œè®¾è®¡æ¨¡å¼åï¼Œç»§ç»­å­¦ä¹ ï¼š
- [å•å…ƒæµ‹è¯•](./å•å…ƒæµ‹è¯•.md)
- [Springæ ¸å¿ƒ](../04-Springç”Ÿæ€/Springæ ¸å¿ƒ.md)

